<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>理解DNS | Qing Yun</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" href="../../rss.xml">
<link rel="canonical" href="http://ls-a.me/posts/dns/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Tao Qingyun">
<link rel="prev" href="../python-name/" title="python值传递 or 引用传递" type="text/html">
<link rel="next" href="../ath10k-firmware-crashed/" title="ath10k firmware crashed" type="text/html">
<meta property="og:site_name" content="Qing Yun">
<meta property="og:title" content="理解DNS">
<meta property="og:url" content="http://ls-a.me/posts/dns/">
<meta property="og:description" content="简介
域名系统（Domain Name System），它最常用的功能就是把域名解析成IP。什么是域名（domain name），计算机在网络中的名字。它能让我们通过名字来找到网络中的机器，而不能去记住那些无意义的IP地址。可以把它想象成一个地址薄，上面记录着域名和IP的对应关系。事实上，在早期确实有这样一个文件HOSTS.TXT，它被网络中的所有主机所共享。但随着网络结构的改变，这种方式变得不可">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2016-09-11T20:23:16+08:00">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="http://ls-a.me/">

                <span id="blog-title">Qing Yun</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="../../archive.html">Archive</a>
                </li>
<li>
<a href="../../categories/">Tags</a>
                </li>
<li>
<a href="../../rss.xml">RSS feed</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<li>
    <a href="index.md" id="sourcelink">Source</a>
    </li>

                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">理解DNS</a></h1>

        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                    Tao Qingyun
            </span></p>
            <p class="dateline"><a href="." rel="bookmark"><time class="published dt-published" datetime="2016-09-11T20:23:16+08:00" itemprop="datePublished" title="2016-09-11 20:23">2016-09-11 20:23</time></a></p>
                <p class="commentline">
        
    <a href="#disqus_thread" data-disqus-identifier="cache/posts/dns.html">Comments</a>


            
        </p>
<p class="sourceline"><a href="index.md" class="sourcelink">Source</a></p>

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <div>
<h3>简介</h3>
<p>域名系统（Domain Name System），它最常用的功能就是把域名解析成IP。什么是域名（domain name），计算机在网络中的名字。它能让我们通过名字来找到网络中的机器，而不能去记住那些无意义的IP地址。可以把它想象成一个地址薄，上面记录着域名和IP的对应关系。事实上，在早期确实有这样一个文件HOSTS.TXT，它被网络中的所有主机所共享。但随着网络结构的改变，这种方式变得不可行。现在的域名系统是一个分布式的数据库，与之对应的，域名本身也是分层的。</p>
<h3>域名结构</h3>
<p>域名是一个树形结构。从下到上以<code>.</code>连接，如<code>A.ISI.EDU</code></p>
<pre class="code literal-block"><span></span>                                   |
                                   |
             +---------------------+------------------+
             |                     |                  |
            MIL                   EDU                ARPA
             |                     |                  |
             |                     |                  |
       +-----+-----+               |     +------+-----+-----+
       |     |     |               |     |      |           |
      BRL  NOSC  DARPA             |  IN-ADDR  SRI-NIC     ACC
                                   |
       +--------+------------------+---------------+--------+
       |        |                  |               |        |
      UCI      MIT                 |              UDEL     YALE 
                |                 ISI
                |                  |
            +---+---+              |
            |       |              |
           LCS  ACHILLES  +--+-----+-----+--------+
            |             |  |     |     |        |
            XX            A  C   VAXA  VENERA Mockapetris
</pre>


<h3>记录（Resouce Record）</h3>
<p>实现上一个域名可以对应多个信息，而IP地址只是其中的一个。这样一个信息被称为这个域名的一个记录或者RR，记录是分类型，比如IP地址是一个A类记录。其他记录类型有AAAA（IPv6地址）、MX（邮件服务地址）、NS（域名服务器）等。DNS被设计为可扩展的，记录类型是可以增加的，因此一个域名理论上可以被解析为任意的消息。</p>
<ul>
<li>A</li>
<li>SOA</li>
<li>NS</li>
<li>PTR</li>
</ul>
<h3>逆向解析</h3>
<h3>Zone Transfer</h3>
<p>一个域名服务器负责整个域名空间的一部分，就像上图中树中的一棵子树。这样的部分空间叫做<code>Zone</code>。每个Zone维护着一个像HOSTS.TXT的文件，上面记录着该空间的所有域名信息。如：</p>
<pre class="code literal-block"><span></span>co.kp.          432000  IN  SOA ns1.co.kp. root.co.kp. 2013082900 28800 86400 1209600 86400
co.kp.          432000  IN  NS  ns1.co.kp.
co.kp.          432000  IN  NS  ns2.co.kp.
ns1.co.kp.      432000  IN  A   175.45.176.15
ns2.co.kp.      432000  IN  A   175.45.176.16
star.co.kp.     432000  IN  NS  ns1.star.co.kp.
star.co.kp.     432000  IN  NS  ns2.star.co.kp.
ns1.star.co.kp.     432000  IN  A   175.45.176.15
ns2.star.co.kp.     432000  IN  A   175.45.176.16
co.kp.          432000  IN  SOA ns1.co.kp. root.co.kp. 2013082900 28800 86400 1209600 86400
</pre>


<p>一个Zone可以有多个域名服务器，以防止单点故障。其中有一台是主服务器，域名信息的改变最先是在主服务器上的，这就需要一个方法来同步所有服务器。DNS使用Zone transfer，与其他DNS消息不同，Zone transfer可以使用TCP，以保证域名信息传输的可靠性，完整性。处于安全考虑，域名服务器可以关闭Zone trnasfer，或者增加一些限制，如只允许指定IP地址的服务器使用Zone transfer。（最近朝鲜顶级域名服务器的错误配置，允许Zone transfer，DNS数据泄露[https://github.com/mandatoryprogrammer/NorthKoreaDNSLeak]）</p>
<h3>DNS实现（组成，报文结构，通讯协议）</h3>
<h3>现实中的DNS（注册域名， 搭建DNS服务器）</h3>
</div>
    </div>
    <aside class="postpromonav"><nav><ul class="pager hidden-print">
<li class="previous">
                <a href="../python-name/" rel="prev" title="python值传递 or 引用传递">Previous post</a>
            </li>
            <li class="next">
                <a href="../ath10k-firmware-crashed/" rel="next" title="ath10k firmware crashed">Next post</a>
            </li>
        </ul></nav></aside><section class="comments hidden-print"><h2>Comments</h2>
        
        
        <div id="disqus_thread"></div>
        <script>
        var disqus_shortname ="ls-a",
            disqus_url="http://ls-a.me/posts/dns/",
        disqus_title="\u7406\u89e3DNS",
        disqus_identifier="cache/posts/dns.html",
        disqus_config = function () {
            this.language = "en";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
    <a href="https://disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>


        </section></article><script>var disqus_shortname="ls-a";(function(){var a=document.createElement("script");a.async=true;a.src="https://"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2018         <a href="mailto:845767657@qq.com">Tao Qingyun</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         
            
        </footer>
</div>
</div>


            <script src="../../assets/js/all-nocdn.js"></script><script>$('a.image-reference:not(.islink) img:not(.islink)').parent().colorbox({rel:"gal",maxWidth:"100%",maxHeight:"100%",scalePhotos:true});</script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates -->
</body>
</html>
